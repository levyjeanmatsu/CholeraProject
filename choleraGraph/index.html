<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Plotly</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>
<body>

<div id="test"></div>
<script src = "choleraLine.js"></script>
<script>
  var data = [{
    x: [0, 10, 20, 30, 40, 50],
    y: [0, 10, 20, 30, 40, 50] }];
  var layout = {font: {size: 18}};
  var config = {responsive: true};
  TESTER = document.getElementById('test');
  Plotly.newPlot(TESTER, data, layout, config);
</script>

<div id="lineChart"></div>
<script>
  var line1 = {
    x: [1, 2, 3, 4],
    y: [12, 15, 13, 17],
    type: 'scatter'
  };

  var line2 = {
    x: [1, 2, 3, 4],
    y: [16, 25, 11, 9],
    type: 'scatter'
  };

  var data1 = [line1, line2];
  lineDiv = document.getElementById('lineChart')
  Plotly.newPlot(lineDiv, data1);
</script>

<div id='attackTable'></div>

<script>
  // source : https://plotly.com/javascript/table/
  Plotly.d3.csv("choleraDeaths.csv", function(err, rows){

    function unpack(rows, key) {
      return rows.map(function(row) { return row[key]; });
    }

    var headerNames = Plotly.d3.keys(rows[0]);
    headerNames.push("Total Attacks");
    headerNames.push("Total Deaths");

    //setting date, attack, and death columns
    var headerValues = [];
    var cellValues = [];
    for (i = 0; i < headerNames.length; i++) {
        headerValues[i] = [headerNames[i]];
        cellValues[i] = unpack(rows, headerNames[i]);
    }
    console.log(cellValues);
    console.log(headerValues);
    console.log(cellValues[2][1]);

    prevTotDeaths = 0;
    prevTotAttacks = 0;
    for (i = 0; i < cellValues[3].length; i++) {
        totalAttacks = Number(cellValues[1][i])+prevTotAttacks;
        totalDeaths = Number(cellValues[2][i])+prevTotDeaths;
        cellValues[3][i] = totalAttacks.toString();
        cellValues[4][i] = totalDeaths.toString();
        prevTotDeaths = totalDeaths;
        prevTotAttacks = totalAttacks;
    }






    // clean date
    for (i = 0; i < cellValues[1].length; i++) {
      var dateValue = cellValues[1][i].split(' ')[0]
      cellValues[1][i] = dateValue
    }


    var data = [{
      type: 'table',
      columnwidth: [600,300,300,300,300],
      columnorder: [0,1,2,3,4],
      header: {
        values: headerValues,
        align: "center",
        line: {width: 1, color: 'rgb(50, 50, 50)'},
        fill: {color: ['rgb(235, 100, 230)']},
        font: {family: "Arial", size: 8, color: "white"}
      },
      cells: {
        values: cellValues,
        align: ["center", "center"],
        line: {color: "black", width: 1},
        fill: {color: ['rgba(228, 222, 249, 0.65)','rgb(235, 193, 238)', 'rgba(228, 222, 249, 0.65)']},
        font: {family: "Arial", size: 9, color: ["black"]}
      }
    }]

    var layout = {
      title: "cholera deaths"
    }

    Plotly.newPlot('attackTable', data, layout);
  });

</script>

</body>
</html>